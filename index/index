<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SREE LAXMI OFFSET PRINTERS</title>

<style>
body{font-family:Arial;background:#f4f4f4;margin:20px}
.container{max-width:1100px;margin:auto;background:#fff;padding:20px;border-radius:10px}
h1{text-align:center}
h2{text-align:center;color:#555}
fieldset{border:1px solid #ccc;padding:10px;margin-bottom:12px;border-radius:8px}
legend{font-weight:bold}
input,select{padding:6px;width:100%;max-width:260px;margin-bottom:6px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ddd;padding:6px;text-align:center}
th{background:#eee}
.amount{background:#eaffd8;font-weight:bold}
button{padding:7px 12px;border:none;border-radius:5px;margin:3px;font-weight:bold;cursor:pointer}
.save{background:#4CAF50;color:#fff}
.clear{background:red;color:#fff}
.wa{background:#25D366;color:#fff}
.edit{background:#ffa502;color:#fff}
.del{background:#ff4757;color:#fff}
.total{font-size:20px;font-weight:bold;text-align:right;background:#e6ffe6;padding:12px;border-radius:6px}
</style>
</head>

<body>
<div class="container">

<h1>ðŸ’  SREE LAXMI OFFSET PRINTERS ðŸ’ </h1>
<h2>Billing System</h2>

<label>Customer Name</label>
<input id="customerName">

<label>WhatsApp Number</label>
<input id="customerWhatsapp">

<label>Date</label>
<input id="billDate" readonly>

<label>Payment Mode</label>
<select id="paymentMode">
<option>Cash</option>
<option>Online</option>
</select>

<!-- NAMUNA BALLOT -->
<fieldset>
<legend>â…› Namuna Ballot</legend>
<select id="namunaCopies">
<option value="0">Select</option>
<option>200</option>
<option>500</option>
<option>600</option>
<option>700</option>
<option>800</option>
<option>900</option>
<option>1000</option>
</select>
<input id="namunaAmount" class="amount" readonly placeholder="Amount">
</fieldset>

<!-- POSTERS -->
<fieldset>
<legend>Posters</legend>
<select id="posterCopies">
<option value="0">Select</option>
<option>100</option>
<option>200</option>
<option>500</option>
<option>1000</option>
</select>
<input id="posterAmount" class="amount" readonly placeholder="Amount">
</fieldset>

<!-- STICKERS -->
<fieldset>
<legend>Stickers (â‚¹60 Each)</legend>
<input type="number" id="stickerCopies" placeholder="Quantity">
<input id="stickerAmount" class="amount" readonly placeholder="Amount">
</fieldset>

<!-- MANUAL ITEM -->
<fieldset>
<legend>Extra / Manual Item</legend>
<input type="text" id="extraTitle" placeholder="Enter item name">
<input type="number" id="extraInput" placeholder="Enter price">
<input id="extraAmount" class="amount" readonly placeholder="Amount">
</fieldset>

<div class="total">
Total Amount: â‚¹ <span id="grandTotal">0</span>
</div>

<button class="clear" onclick="clearForm()">Clear</button>
<button class="save" onclick="saveEntry()">Save</button>
<button class="wa" onclick="sendWhatsApp()">Send WhatsApp</button>

<h2>Saved Bills</h2>

<table>
<thead>
<tr>
<th>S.No</th>
<th>Name</th>
<th>Date</th>
<th>Payment</th>
<th>Original</th>
<th>Edited</th>
<th>Action</th>
</tr>
</thead>
<tbody id="savedTable"></tbody>
</table>

</div>

<script>
let savedBills=[];
let nextId=1;

// RATE TABLES
const namunaRates={200:700,500:1400,1000:1200};
const posterRates={100:350,200:700,500:900,1000:2400};

function autoRate(c,table){
c=parseInt(c)||0;
if(c<=0)return 0;
if(table[c])return table[c];
const k=Object.keys(table).map(Number).sort((a,b)=>a-b);
let l=null,h=null;
for(let x of k){if(x<c)l=x;if(x>c){h=x;break}}
if(!l)return table[k[0]];
if(!h)return table[k[k.length-1]];
return Math.round(table[l]+(c-l)*(table[h]-table[l])/(h-l));
}

function updateTotals(){
const n = autoRate(namunaCopies.value, namunaRates);
const p = autoRate(posterCopies.value, posterRates);
const s = (parseInt(stickerCopies.value)||0)*60;
const e = parseInt(extraInput.value)||0;

namunaAmount.value = n || "";
posterAmount.value = p || "";
stickerAmount.value = s || "";
extraAmount.value = e || "";

grandTotal.textContent = n + p + s + e;
}

document.querySelectorAll("input,select").forEach(el=>{
el.addEventListener("input",updateTotals);
el.addEventListener("change",updateTotals);
});

function clearForm(){
document.querySelectorAll("input").forEach(i=>{if(i.id!=="billDate")i.value=""});
document.querySelectorAll("select").forEach(s=>{if(s.id!=="paymentMode")s.value="0"});
grandTotal.textContent=0;
billDate.value=new Date().toLocaleDateString("en-IN");
}

function saveEntry(){
const total=parseInt(grandTotal.textContent);
if(!total)return alert("No amount");
savedBills.push({
id:nextId++,
name:customerName.value||"-",
date:billDate.value,
paymentMode:paymentMode.value,
originalTotal:total,
editedTotal:null
});
localStorage.setItem("slp_savedBills",JSON.stringify(savedBills));
render();
clearForm();
}

function render(){
savedTable.innerHTML="";
savedBills.forEach((b,i)=>{
savedTable.innerHTML+=`
<tr>
<td>${i+1}</td>
<td>${b.name}</td>
<td>${b.date}</td>
<td>${b.paymentMode}</td>
<td>â‚¹${b.originalTotal}</td>
<td>${b.editedTotal??"-"}</td>
<td>
<button class="edit" onclick="edit(${b.id})">Edit</button>
<button class="del" onclick="del(${b.id})">Delete</button>
</td>
</tr>`;
});
}

function edit(id){
const b=savedBills.find(x=>x.id===id);
const v=prompt("Enter new amount",b.editedTotal??b.originalTotal);
if(v!==null)b.editedTotal=parseInt(v)||b.originalTotal;
localStorage.setItem("slp_savedBills",JSON.stringify(savedBills));
render();
}

function del(id){
savedBills=savedBills.filter(b=>b.id!==id);
localStorage.setItem("slp_savedBills",JSON.stringify(savedBills));
render();
}

function sendWhatsApp(){
updateTotals();
const num=(customerWhatsapp.value||"").replace(/\D/g,"");
if(num.length<10)return alert("Invalid number");

let extraLine = extraTitle.value
  ? `\n${extraTitle.value}: â‚¹${extraAmount.value||0}`
  : "";

const msg=`SREE LAXMI OFFSET PRINTERS
Customer: ${customerName.value}
Date: ${billDate.value}
Total: â‚¹${grandTotal.textContent}${extraLine}`;

window.open(`https://wa.me/91${num}?text=`+encodeURIComponent(msg));
}

window.onload=()=>{
billDate.value=new Date().toLocaleDateString("en-IN");
const d=localStorage.getItem("slp_savedBills");
if(d){savedBills=JSON.parse(d);render();}
};
</script>

</body>

</html>
